<!DOCTYPE html>
<html lang="en">
<head>
	<title>JS FE</title> 
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>


<script>

// OOP 

// OOP Principles: Наслідування Інкапсуляція Поліморфізм Абстракція

let animal = {
	name: 'Some random animal',
	paws: 4,
	move(){
		console.log(`${this.name} is moving`);
	}
}

let dog = {
	name: 'Dog',
	bark(){
		console.log(`${this.name}: Woof! Woof!`);
	}
}

dog.__proto__ = animal; // тепер собака має доступ до методів та властивостей тварини

for(let prop in dog){
	// console.log(prop); // виведе всі методи та властивості включно з батьківськими
	if(dog.hasOwnProperty(prop)){ // фільтрує лише ті властивості та методи, які описані саме для цього обʼєкта
		console.log(prop);
	}
}	

let husky = {
	eyes: 'blue',
	hobbys: ['run', 'snow', 'howl'],
	__proto__: dog
}

//animal.__proto__ = husky // Cyclic __proto__ value


// OOP in finctional style

function Device(name, power, type){
	this.name = name; // public property
	this.type = type;
	this.enabled = false;
	const pow = power; // private property
	console.log(`Was created new ${this.type} ${this.name} with ${pow}Wt`);

	this.enable = function(){
		this.enabled = true;
		console.log(`${this.type} ${this.name} was enabled`);
	}
	this.disable = () =>{
		this.enabled = false;
		console.log(`${this.type} ${this.name} was disabled`);
	}
}

let fridge = new Device('Samsung', 750, 'fridge');
fridge.enable(); // fridge Samsung was enabled


function CoffeeMachine(name, power, type='Coffeemachine'){
	Device.call(this, name, power, type);

	this.waterTank = 1200; // l
	this._waterAmount = 0; // protected variable
	this._coffeeAmount = 0;
	const minCoffee = 20;
	const minWater = 150;
	let waterTemp = 20;
	this.isReady = false;

	let parentEnable = this.enable.bind(this); // ми зберігаємо в окрему змінну той функціонал,
	// котрий ми успадкували від базового класу та привʼязуємо контекст визову цієї функції до нашої кавомашини
	
	this.enable = () => {
		parentEnable();
		if(this.waterAmount < minWater){
			console.error('No water! Fill in');
		}
		else{
			setTimeout(()=> {
				this.isReady = true;
				waterTemp = 98;
				console.warn(`${this.name} is ready`);
			}, 2000);
		}
	}

	this.getWaterAmount = () => this._waterAmount;

	this.setWaterAmount = (amount) => {
		if(amount < 0 || amount + this._waterAmount > this.waterTank || typeof amount != 'number'){
			console.error('Error! Incorrect input in water tank!');
		}
		else{
			this._waterAmount += amount;
			console.log(`Added ${amount}ml of water`);
		}
	}

	this.getCoffeeAmount = () => this._coffeeAmount;

	this.setCoffeeAmount = (amount) => {
		if(amount < 0 || typeof amount != 'number'){
			console.error('Error! Incorrect input in coffee tank!');
		}
		else{
			this._coffeeAmount += amount;
			console.log(`Added ${amount}g coffee`);
		}
	}
	
	this.brew = (drink) => {
		if(!this.enabled){
			console.error('Turn on device');
			return false;
		}
		if(this._waterAmount < minWater ){
			console.error('Not enough water!');
			return false;
		}
		if(this._coffeeAmount < minCoffee){
			console.error('Not enough coffee!');
			return false;
		}
		if(!this.isReady){
			console.error('Not ready!');
			return false;
		}
		let time = 0;
		switch(drink){
			case 'espresso': this._waterAmount -= 30;
							 this._coffeeAmount -= 8;
							 time = 500;
							 break;
			case 'doppio': this._waterAmount -= 60;
							 this._coffeeAmount -= 16;
							 time = 700;
							 break;
			case 'americano': this._waterAmount -= 120;
							 this._coffeeAmount -= 8;
							 time = 900;
							 break;
			case 'ristretto': this._waterAmount -= 15;
							 this._coffeeAmount -= 8;
							 time = 300;
							 break;
		}
		setTimeout(()=> console.log(`${drink} is ready!`), time);
	}
}

let saeco = new CoffeeMachine('Saeco', 900);

console.log(saeco.getWaterAmount());
saeco.setWaterAmount(3000);
saeco.setWaterAmount(800);
saeco.enable();
saeco.setCoffeeAmount(100);
saeco.brew('espresso');





</script>
</body>
</html>
