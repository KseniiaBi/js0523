const filterHeaders=document.querySelectorAll(".group .header");function expandFilter(e){e.parentNode.classList.toggle("active"),e.parentNode.classList.toggle("inactive")}document.addEventListener("click",e=>{e.target.classList.contains("btn-mini")&&addToCart(e.target.dataset.id)}),filterHeaders.forEach(e=>{e.onclick=()=>expandFilter(e)});const products=document.querySelectorAll(".catalogue .item"),filters=document.querySelectorAll(".filters .group input"),filterShowing={categories:[],minPrice:0,maxPrice:1/0};function showFilteredProducts(){products.forEach(e=>{let t=e.querySelector(".price p").textContent;t=Number(t.substring(0,t.length-4)),filterShowing.categories.includes(e.dataset.group)&&t>=filterShowing.minPrice&&t<=filterShowing.maxPrice?e.style.display="block":e.style.display="none"})}filters.forEach(t=>{t.onchange=()=>{var e=t.value;t.checked?filterShowing.categories.push(e):filterShowing.categories.splice(filterShowing.categories.indexOf(e),1),showFilteredProducts()}});const priceMin=document.querySelector(".price .minimal"),priceMax=document.querySelector(".price .maximal");function filterByprice(){var e=""!=priceMin.value?priceMin.value:0,t=""!=priceMax.value?priceMax.value:1/0;filterShowing.minPrice=e,filterShowing.maxPrice=t,showFilteredProducts()}null!=priceMax&&(priceMax.onchange=filterByprice,priceMin.onchange=filterByprice);let storage=window.localStorage;const APP_NAME="Aestetics_shop",url="js/data.json";let shopData,promise=fetch(url);promise.then(e=>e.text()).then(e=>{shopData=JSON.parse(e)});const cart=null!=storage.getItem(APP_NAME)?JSON.parse(storage.getItem(APP_NAME)):[];function addToCart(t,r=1){let n,o=(shopData.forEach(e=>{e.id===+t&&(n=e)}),!1);cart.forEach(e=>{e.id===+t&&(o=!0,e.count+=r)}),o||cart.push({...n,count:1}),saveCartToLS()}function saveCartToLS(){storage.setItem(APP_NAME,JSON.stringify(cart))}const cart_inner=document.querySelector(".cart_inner");function buildCart(){cart.forEach(r=>{var e=document.createElement("div"),t=(e.classList.add("cart_item"),new Image),n=(t.src=r.img,document.createElement("div"));n.classList.add("prod_name"),n.innerText=r.name;const o=document.createElement("input"),a=(o.type="number",o.classList.add("counter"),o.value=r.count,o.onchange=()=>{let t=o.value;cart.forEach(e=>{e.id===r.id&&(e.count=t,saveCartToLS())})},document.createElement("div").classList.add("price"),document.createElement("div"));a.classList.add("del"),a.onclick=()=>{cart.forEach((e,t)=>{e.id===r.id&&(a.parentNode.remove(),cart.splice(t,1),saveCartToLS())})},e.append(t,n,o,a),cart_inner.append(e)})}window.location.href.includes("cart")&&buildCart();const form=document.querySelector("form.bottom-group"),nameInput=document.querySelector("input#name"),phoneInput=document.querySelector("input#telephone"),formEndpoint="mail.php";form.onsubmit=t=>{if(t.preventDefault(),phoneInput.value.match(/^\+38 \(\d{3}\) [0-9]{3} [0-9]{2} [0-9]{2}/)){t=new FormData;t.append("name",nameInput.value),t.append("telephone",phoneInput.value);let e=new XMLHttpRequest;e.open("GET",formEndpoint),e.send(t),e.onload=()=>{200===e.status?(console.log("Success!"),nameInput.value="",phoneInput.value=""):console.error(e.status)}}else phoneInput.style.border="1px solid red",alert("Fill your phone in format +38 (000) 000 00 00")};